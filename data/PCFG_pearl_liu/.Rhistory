d_dev12_long = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers_12_13/", model, "_mixed.0.deVilliers_12_13_ld.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(1:4) ~ "acceptable",
rowname %in% c(4:13) ~ "unacceptable"),
dependency_length = 'long',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_dev12_short = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers_12_13/", model, "_mixed.0.deVilliers_12_13_sd.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(1:4) ~ "acceptable",
rowname %in% c(4:13) ~ "unacceptable"),
dependency_length = 'short',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
# percentage difference
long_dev12 <- d_dev12_long$length_factorized
short_dev12 <- d_dev12_short$length_factorized
long_dev12_pref = exp(long_dev12)/ (exp(long_dev12) + exp(short_dev12))
## putting it all together in plot ##
# still using d1 from the standard devilliers plot above but modifying 8 and 12
d1$long_pref[8] = mean(long_dev8_pref)
d1$long_pref[12] = mean(long_dev12_pref)
plot.dev_mult_stim <- ggplot(data = d1[c(1:12),], mapping = aes(x = as.numeric(rowname), y = long_pref, label = rowname)) +
geom_label() +
ylab("Predicted Long-Distance Preference") +
xlab("de Villiers Item Number") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
ggtitle('De Villiers Pred Preferences multiple stimuli')
# ## testing additional stimuli ##
# d_devtest_long = read.csv(paste("~/Desktop/FG_project/data/", model, "_dev_test/", model, "_mixed.0.dev_test_ld.results.csv", sep = '')) %>%
#   tibble::rownames_to_column(var = "rowname") %>%
#   mutate(dependency_length = 'long',
#          length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
#
# d_devtest_short = read.csv(paste("~/Desktop/FG_project/data/", model, "_dev_test/", model, "_mixed.0.dev_test_sd.results.csv", sep = '')) %>%
#   tibble::rownames_to_column(var = "rowname") %>%
#   mutate(dependency_length = 'short',
#          length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
#
# long_devtest <- d_devtest_long$length_factorized
# short_devtest <- d_devtest_short$length_factorized
#
# long_devtest_pref = exp(long_devtest)/ (exp(long_devtest) + exp(short_devtest))
### Omaki ###
# d1 = read.csv(paste("~/Desktop/FG_project/data/", model, "_omaki/", model, "_highses.0.omaki_stim_ld.results.csv", sep = '')) %>%
#   tibble::rownames_to_column(var = "rowname") %>%
#   mutate(verb = case_when(grepl('say', Sentence, fixed = TRUE) ~ 'say',
#                           grepl('tell', Sentence, fixed = TRUE) ~ 'tell'),
#          dependency_length = 'long',
#          length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
#
# d2 = read.csv(paste("~/Desktop/FG_project/data/FG_omaki/FG_highses.0.omaki_stim_sd.results.csv", sep = '')) %>%
#   tibble::rownames_to_column(var = "rowname") %>%
#   mutate(verb = case_when(grepl('say', Sentence, fixed = TRUE) ~ 'say',
#                           grepl('tell', Sentence, fixed = TRUE) ~ 'tell'),
#          dependency_length = 'short',
#          length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1),)
#
# d = rbind.data.frame(d1,d2)
#
# p_omaki_raw <- ggplot(data = d, mapping = aes(x = verb, y = length_factorized, label = rowname, color = dependency_length)) +
#   geom_label(position = "jitter") + xlab("stimuli") +
#   ggtitle("Omaki length factorized")
#
# # short preference (aka main verb preference)
# long <- d1$length_factorized
# short <- d2$length_factorized
# # converting into prob then getting a long preference
# d2$short_pref <- exp(short)/ (exp(long) + exp(short))
#
# p_omaki_pref <- ggplot(data = d2, mapping = aes(x = verb, y = short_pref)) +
#   geom_col() +
#   ggtitle("Omaki preference")
### Final Plot list ###
pdf(paste("~/Desktop/FG_project/plots/",model,"_plots_3_3_23.pdf", sep = ''))
# liu.plot
liu.plot.lenfac
# grid.plot
grid_len.plot
mod_diff_p
final_mod_beh_diff_plot
# p_orig_dev
# plot.dev
# plot.dev_mult_stim
comb.plot.dev
# p_omaki_raw
# p_omaki_pref
dev.off()
library(tidyverse)
library(forcats)
library(plotrix)
library(stringr)
library(ggpubr)
library(patchwork)
# doing this a lot so will create a variable for folder the data is in
model = "PCFG"
# loading Liu et al. and Pearl and Sprouse data
setwd(paste("~/Desktop/FG_project/data/", model, "_pearl_liu", sep = ''))
temp = list.files(pattern="*.csv")
for (i in 1:length(temp)) assign(str_split_fixed(temp[i], ".0.", 2)[,2], read.csv(temp[i])) # lopping off the model run name
# liu et al stim data
bridge = liu_bridge.results.csv %>%
mutate(condition = 'bridge')
factive = liu_factive.results.csv %>%
mutate(condition = 'factive')
manner = liu_manner.results.csv %>%
mutate(condition = 'manner')
other = liu_other.results.csv %>%
mutate(condition = 'other')
d = rbind.data.frame(bridge, factive, manner, other)
d = d %>% mutate(Sentence = as.character(Sentence)) %>%
mutate(matrix_verb = word(Sentence, 2),
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
# loading verb-frame frequency data from liu et al
v_freq = read.csv("~/Desktop/FG_project/data/frequency_48verbs_unified_osf.csv")
insidescore_w_vfreq = d %>%
group_by(matrix_verb, condition) %>%
dplyr::summarise(InsideScore = mean(InsideScore),
LenFac = mean(length_factorized)) %>%
inner_join(v_freq)
### pearl & sprouse stim data
# matrix
matrix_non_is = pearl_stim_matrix.results.csv %>%
mutate(condition = 'matrix', island = "non-island structure")
matrix_is = pearl_stim_matrix.results.csv %>%
mutate(condition = 'matrix', island = "island structure")
# complex NP
np_emb_is = pearl_stim_np_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
np_emb_non_is = pearl_stim_np_emb_non_is.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
# subject
subject_emb_is = pearl_stim_subj_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
subject_emb_non_is = pearl_stim_subj_emb_nonis.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
# adjunct
adjunct_emb_is = pearl_stim_adjunct_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
adjunct_emb_non_is = pearl_stim_adjunct_emb_nonis.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
# whether
whether_emb_is = pearl_stim_whether_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
whether_emb_non_is = pearl_stim_whether_emb_nonis.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
d_np = rbind.data.frame(matrix_non_is, matrix_is, np_emb_non_is, np_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_subj = rbind.data.frame(matrix_non_is, matrix_is, subject_emb_non_is, subject_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_adjunct = rbind.data.frame(matrix_non_is, matrix_is, adjunct_emb_non_is, adjunct_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_whether = rbind.data.frame(matrix_non_is, matrix_is, whether_emb_non_is, whether_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
### liu plots ###
liu.plot <- ggplot(insidescore_w_vfreq, mapping = aes(x = log_fre, y = InsideScore)) +
stat_smooth(method = lm) +
geom_label(aes(label = matrix_verb)) + # , color = condition
xlab("Log-transformed frequency of verb frame") +
ylab("Log probability") +
labs(color = "Verb type")
liu.plot.lenfac <- ggplot(insidescore_w_vfreq, mapping = aes(x = log_fre, y = LenFac)) +
stat_smooth(method = lm) +
geom_label(aes(label = matrix_verb)) + # , color = condition
xlab("Log-transformed frequency of verb frame") +
ylab("Length Factorized Score") +
labs(color = "Verb type")
### Pearl and Sprouse plots ###
toplot.df <- d_adjunct %>%
mutate(island_type = 'adjunct') %>%
rbind(d_np %>%
mutate(island_type = 'np')) %>%
rbind(d_subj %>%
mutate(island_type = 'subj')) %>%
rbind(d_whether %>%
mutate(island_type = 'whether')) %>%
mutate(condition = factor(condition,levels=c('matrix','embedded'))) %>%
mutate(island_type = as.character(island_type)) %>%
mutate(island_type = case_when(island_type == 'np' ~  'Complex NP Island',
island_type == 'subj' ~ 'Subject Island',
island_type == 'whether' ~ 'Whether Island',
island_type == 'adjunct' ~ 'Adjunct Island')) %>%
mutate(island_type = factor(island_type, levels=c('Complex NP Island','Subject Island','Whether Island','Adjunct Island')))
grid.plot <- toplot.df %>%
group_by(island_type,condition,island) %>%
dplyr::summarise(mean_InsideScore = mean(InsideScore),
stdErr = std.error(InsideScore)) %>%
ggplot(data=.,aes(x=condition,y=mean_InsideScore,color=island)) +
geom_point() +
geom_line(aes(group=island)) +
geom_errorbar(aes(x=condition, ymin = mean_InsideScore - stdErr, ymax = mean_InsideScore + stdErr), width=0.1) +
facet_wrap(~island_type,ncol=4) +
labs(y='Log Probability',x='Condition',color=element_blank()) +
theme(legend.position = 'bottom')
grid_len.plot <- toplot.df %>%
group_by(island_type,condition,island) %>%
dplyr::summarise(mean_length_factorized = mean(length_factorized), stdErr = std.error(length_factorized)) %>%
ggplot(data=.,aes(x=condition,y=mean_length_factorized,color=island)) +
geom_point() +
geom_line(aes(group=island)) +
geom_errorbar(aes(x=condition, ymin = mean_length_factorized - stdErr, ymax = mean_length_factorized + stdErr), width=0.1) +
facet_wrap(~island_type,ncol=4) +
labs(y='Log prob length factorized',x='Condition',color=element_blank()) +
theme(legend.position = 'bottom')
se_2mean <- function(vec) {
main = sqrt(vec[1]+vec[2])/4
return(main)
}
full_sprouse_diff <- data.frame(condition = c(rep("matrix", 8), rep("embedded", 8)),
island_type = rep(c("Complex NP Island", "Complex NP Island", "Subject Island", "Subject Island", "Whether Island", "Whether Island", "Adjunct Island", "Adjunct Island"), 2),
island = rep(c("non-island structure", "island structure"),8),
z_score = c(0.86, 0.75, 0.85, 0.75, 1.23, 0.71, 0.62, 0.11, 0.18, -0.73, 0.38, -0.97, 0.38, -0.73, 0.23, -0.97),
sd = c(0.76, 0.71, 0.77, 0.79, 0.74, 0.67, 0.80, 0.81, 0.82, 0.57, 0.83, 0.61, 0.72, 0.63, 0.79, 0.72)) %>%
mutate(condition = fct_relevel(condition, "matrix", "embedded"),
island_type = fct_relevel(island_type, "Complex NP Island", "Subject Island", "Whether Island", "Adjunct Island"),
var = sd^2)
se_2mean2 <- function(vec) {
main = sqrt(vec[1]+vec[2])/sqrt(173)
return(main)
}
diff_beh_df <- full_sprouse_diff %>%
group_by(condition, island_type) %>%
dplyr::summarise(diff = -diff(z_score), se = se_2mean2(var))
diff_mod_df <- toplot.df %>%
group_by(island_type,condition,island) %>%
dplyr::summarise(mean_length_factorized = -mean(length_factorized), var = var(length_factorized)) %>%
mutate_all(~replace(., is.na(.), 0)) %>%
group_by(condition, island_type) %>%
dplyr::summarise(diff = -diff(mean_length_factorized), se = se_2mean(var))
create_plot <- function(model_df, island_chars) {
LenFac_diff_mod.df <- filter(model_df, island_type == island_chars)
LenFac_diff_beh.df <- filter(diff_beh_df, island_type == island_chars) #diff_beh_df is the sprouse df
# scaleFactor <- max(LenFac_diff_mod.df$diff) / max(LenFac_diff_beh.df$diff)
scaleFactor <- 4.4
p <- ggplot(data=LenFac_diff_mod.df,aes(x=condition)) +
geom_point(aes(y=diff), col="#009E73", size = 2, show.legend = F) +
geom_point(data = LenFac_diff_beh.df, aes(y=diff * scaleFactor, color = '#CC79A7'), size = 2, show.legend = T) +
scale_y_continuous(name="model diff", sec.axis=sec_axis(~./scaleFactor, name="behavior diff"), limits = c(-1.5,14)) +
geom_line(aes(y = diff, group=island_type), color = "#009E73", linetype="dashed") +
geom_line(data = LenFac_diff_beh.df, aes(y=diff * scaleFactor, color = '#CC79A7', group=island_type)) +
geom_errorbar(aes(ymin = diff - se, ymax = diff + se), width=0.2, color = "#009E73") +
geom_errorbar(data = LenFac_diff_beh.df, aes(ymin = diff * scaleFactor - se, ymax = diff * scaleFactor + se), width=0.2, color = "#CC79A7") +
theme_bw() +
theme(legend.position = 'bottom',
plot.title = element_text(hjust = 0.5),
axis.title.y.left=element_text(color="#009E73"),
axis.text.y.left=element_text(color="#009E73"),
axis.title.y.right=element_text(color="#CC79A7"),
axis.text.y.right=element_text(color="#CC79A7"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
) +
guides(color = "none")+
scale_color_manual(values = c('#CC79A7'), labels = c('')) +
# scale_color_manual(name='Regression Model',
#                    breaks=c('Linear', 'Quadratic', 'Cubic'),
#                    values=c('Cubic'='pink', 'Quadratic'='blue', 'Linear'='purple')) +
ggtitle(island_chars)
return(p)
}
diff_np_p = create_plot(diff_mod_df, "Complex NP Island")
diff_subj_p = create_plot(diff_mod_df, "Subject Island")
diff_adj_p = create_plot(diff_mod_df, "Adjunct Island")
diff_whether_p = create_plot(diff_mod_df, "Whether Island")
final_mod_beh_diff_plot <- guide_area() + (diff_np_p + diff_subj_p + diff_adj_p + diff_whether_p) +
plot_layout(guides = "collect",
nrow = 2, heights = c(1,500)) +
plot_annotation(title = paste(model, "Model")) &
theme(legend.position = "top", plot.title = element_text(hjust = 0.5))
final_mod_beh_diff_plot
mod_diff_plot <- function(model_df, island_chars) {
LenFac_diff_mod.df <- filter(model_df, island_type == island_chars)
p <- ggplot(data=LenFac_diff_mod.df,aes(x=condition, y = diff)) +
geom_point(aes(y=diff), size = 2, color = "#009E73") +
geom_line(aes(y = diff, group=island_type), color = "#009E73") +
geom_errorbar(aes(ymin = diff - se, ymax = diff + se), width=0.2, color = "#009E73") +
ylim(-1.5,14) +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
) +
ggtitle(island_chars)
return(p)
}
mod_diff_np_p = mod_diff_plot(diff_mod_df, "Complex NP Island")
mod_diff_subj_p = mod_diff_plot(diff_mod_df, "Subject Island")
mod_diff_adj_p = mod_diff_plot(diff_mod_df, "Adjunct Island")
mod_diff_whether_p = mod_diff_plot(diff_mod_df, "Whether Island")
mod_diff_p <- guide_area() + (mod_diff_np_p + mod_diff_subj_p + mod_diff_adj_p + mod_diff_whether_p) +
plot_layout(guides = "collect",
nrow = 2, heights = c(1,500)) +
plot_annotation(title = paste(model, "Model")) &
theme(legend.position = "top", plot.title = element_text(hjust = 0.5))
mod_diff_p
### De Villiers results ###
d1 = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers/", model, "_mixed.0.devillier_stim_ld_wug.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(1:4) ~ "acceptable",
rowname %in% c(4:13) ~ "unacceptable"),
dependency_length = 'long',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d2 = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers/", model, "_mixed.0.devillier_stim_sd_wug.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(2:13) ~ "acceptable",
rowname %in% c(1) ~ "unacceptable"),
dependency_length = 'short',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
# want to add long distance preferences from the de Villiers paper
d3 = d1
d3$ld_preference = c(0.79, 0.48, 0.80, 0.25, 0.04, 0.03, 0.04, 0.09, 0.20, NA, NA, NA, NA)
p_orig_dev <- ggplot(data = d3[c(1:9),], mapping = aes(x = rowname, y = ld_preference, label = rowname)) +
geom_label() +
ggtitle('De Villiers Original Data')
# percentage difference
long <- d1$length_factorized
short <- d2$length_factorized
d1$long_pref = exp(long)/ (exp(long) + exp(short))
plot.dev <- ggplot(data = d1, mapping = aes(x = as.numeric(rowname), y = long_pref, label = rowname)) +
geom_label() +
ylim(c(0,1)) +
ylab("Predicted Long-Distance Preference") +
xlab("de Villiers Item Number") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
ggtitle('De Villiers Predicted Preferences')
combined_prefs <- tibble(pref = c(d1$long_pref[1:9], d3$ld_preference[1:9]),
type = c(rep("Model Prediction", 9), rep("Child Preference", 9)),
item = c(c(1:9),c(1:9)))
comb.plot.dev <- ggplot(data = combined_prefs, mapping = aes(x = item, y = pref, label = item)) +
geom_label(aes(color = type), size = 5) +
geom_line(aes(color = type)) +
ylim(c(0,1)) +
ylab("Long-Distance Preference") +
xlab("de Villiers Item Number") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
ggtitle('De Villiers Stimuli Preferences')
### De Villiers multiple stimuli results ###
## 8 ##
d_dev8_long = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers_8/", model, "_mixed.0.deVilliers_8_ld.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(1:4) ~ "acceptable",
rowname %in% c(4:13) ~ "unacceptable"),
dependency_length = 'long',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_dev8_short = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers_8/", model, "_mixed.0.deVilliers_8_sd.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(1:4) ~ "acceptable",
rowname %in% c(4:13) ~ "unacceptable"),
dependency_length = 'short',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
# percentage difference
long_dev8 <- d_dev8_long$length_factorized
short_dev8 <- d_dev8_short$length_factorized
long_dev8_pref = exp(long_dev8)/ (exp(long_dev8) + exp(short_dev8))
## 12 and 13 ##
d_dev12_long = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers_12_13/", model, "_mixed.0.deVilliers_12_13_ld.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(1:4) ~ "acceptable",
rowname %in% c(4:13) ~ "unacceptable"),
dependency_length = 'long',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_dev12_short = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers_12_13/", model, "_mixed.0.deVilliers_12_13_sd.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(1:4) ~ "acceptable",
rowname %in% c(4:13) ~ "unacceptable"),
dependency_length = 'short',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
# percentage difference
long_dev12 <- d_dev12_long$length_factorized
short_dev12 <- d_dev12_short$length_factorized
long_dev12_pref = exp(long_dev12)/ (exp(long_dev12) + exp(short_dev12))
## putting it all together in plot ##
# still using d1 from the standard devilliers plot above but modifying 8 and 12
d1$long_pref[8] = mean(long_dev8_pref)
d1$long_pref[12] = mean(long_dev12_pref)
plot.dev_mult_stim <- ggplot(data = d1[c(1:12),], mapping = aes(x = as.numeric(rowname), y = long_pref, label = rowname)) +
geom_label() +
ylab("Predicted Long-Distance Preference") +
xlab("de Villiers Item Number") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
ggtitle('De Villiers Pred Preferences multiple stimuli')
# ## testing additional stimuli ##
# d_devtest_long = read.csv(paste("~/Desktop/FG_project/data/", model, "_dev_test/", model, "_mixed.0.dev_test_ld.results.csv", sep = '')) %>%
#   tibble::rownames_to_column(var = "rowname") %>%
#   mutate(dependency_length = 'long',
#          length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
#
# d_devtest_short = read.csv(paste("~/Desktop/FG_project/data/", model, "_dev_test/", model, "_mixed.0.dev_test_sd.results.csv", sep = '')) %>%
#   tibble::rownames_to_column(var = "rowname") %>%
#   mutate(dependency_length = 'short',
#          length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
#
# long_devtest <- d_devtest_long$length_factorized
# short_devtest <- d_devtest_short$length_factorized
#
# long_devtest_pref = exp(long_devtest)/ (exp(long_devtest) + exp(short_devtest))
### Omaki ###
# d1 = read.csv(paste("~/Desktop/FG_project/data/", model, "_omaki/", model, "_highses.0.omaki_stim_ld.results.csv", sep = '')) %>%
#   tibble::rownames_to_column(var = "rowname") %>%
#   mutate(verb = case_when(grepl('say', Sentence, fixed = TRUE) ~ 'say',
#                           grepl('tell', Sentence, fixed = TRUE) ~ 'tell'),
#          dependency_length = 'long',
#          length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
#
# d2 = read.csv(paste("~/Desktop/FG_project/data/FG_omaki/FG_highses.0.omaki_stim_sd.results.csv", sep = '')) %>%
#   tibble::rownames_to_column(var = "rowname") %>%
#   mutate(verb = case_when(grepl('say', Sentence, fixed = TRUE) ~ 'say',
#                           grepl('tell', Sentence, fixed = TRUE) ~ 'tell'),
#          dependency_length = 'short',
#          length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1),)
#
# d = rbind.data.frame(d1,d2)
#
# p_omaki_raw <- ggplot(data = d, mapping = aes(x = verb, y = length_factorized, label = rowname, color = dependency_length)) +
#   geom_label(position = "jitter") + xlab("stimuli") +
#   ggtitle("Omaki length factorized")
#
# # short preference (aka main verb preference)
# long <- d1$length_factorized
# short <- d2$length_factorized
# # converting into prob then getting a long preference
# d2$short_pref <- exp(short)/ (exp(long) + exp(short))
#
# p_omaki_pref <- ggplot(data = d2, mapping = aes(x = verb, y = short_pref)) +
#   geom_col() +
#   ggtitle("Omaki preference")
### Final Plot list ###
pdf(paste("~/Desktop/FG_project/plots/",model,"_plots_3_3_23.pdf", sep = ''))
# liu.plot
liu.plot.lenfac
# grid.plot
grid_len.plot
mod_diff_p
final_mod_beh_diff_plot
# p_orig_dev
# plot.dev
# plot.dev_mult_stim
comb.plot.dev
# p_omaki_raw
# p_omaki_pref
dev.off()
library(tidyverse)
### De Villiers results ###
d_lex = read_csv("~/Desktop/FG_project/data/lex_trigram_model_dev_results.csv")
d_phrasal = read_csv("~/Desktop/FG_project/data/phrasal_trigram_model_dev_results.csv")
d_lexcp = read_csv("~/Desktop/FG_project/data/lexcp_trigram_model_dev_results.csv")
d_lexmv = read_csv("~/Desktop/FG_project/data/lexmv_trigram_model_dev_results.csv")
fix_d <- function(d) {
new_d = d %>%
mutate(length_factorized = log_prob / str_count(trigrams, "\\)"),
length = str_count(trigrams, "\\)"))
# help = length(trigrams)) # still not sure why this is only giving first element
return(new_d)
}
new_d_lex = fix_d(d_lex)
new_d_phrasal = fix_d(d_phrasal)
new_d_lexcp = fix_d(d_lexcp)
new_d_lexmv = fix_d(d_lexmv)
# plot human long distance preferences from the de Villiers paper
d3 = filter(new_d_lex, condition == "ld")
d3$ld_preference = c(0.79, 0.48, 0.80, 0.25, 0.04, 0.03, 0.04, 0.09, 0.20, NA, NA, NA, NA)
p_orig_dev <- ggplot(data = d3[c(1:9),], mapping = aes(x = rownames(d3)[1:9], y = ld_preference, label = rownames(d3)[1:9])) +
geom_label() +
ggtitle('De Villiers Original Data')
# percentage difference
main_plot <- function(new_d, title) {
d1 = filter(new_d, condition == "ld") %>%
mutate(rowname = row_number())
d2 = filter(new_d, condition == "sd")
long <- d1$length_factorized
short <- d2$length_factorized
d1$long_pref = exp(long)/ (exp(long) + exp(short))
ld_preference = c(0.79, 0.48, 0.80, 0.25, 0.04, 0.03, 0.04, 0.09, 0.20)
combined_prefs <- tibble(pref = c(d1$long_pref[1:9], ld_preference),
type = c(rep("Model Prediction", 9), rep("Child Preference", 9)),
item = c(c(1:9),c(1:9)))
comb.plot.dev <- ggplot(data = combined_prefs, mapping = aes(x = item, y = pref, label = item)) +
geom_label(aes(color = type), size = 5) +
geom_line(aes(color = type)) +
ylim(c(0,1)) +
ylab("Long-Distance Preference") +
xlab("de Villiers Item Number") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
ggtitle(paste('De Villiers Stimuli Preferences', title))
# plot.dev <- ggplot(data = d1, mapping = aes(x = as.numeric(rowname), y = long_pref, label = rowname)) +
#   geom_label() +
#   ylim(c(0,1)) +
#   ylab("Predicted Long-Distance Preference") +
#   xlab("de Villiers Item Number") +
#   theme(axis.text.x=element_blank(),
#         axis.ticks.x=element_blank()) +
#   ggtitle(title)
print(comb.plot.dev)
}
# pdf("~/Desktop/FG_project/plots/tri_baseline_dev_plots.pdf")
main_plot(new_d_lex, "Lex Trigram")
main_plot(new_d_phrasal, "Phrasal Trigram")
main_plot(new_d_lexcp, "Lex CP Trigram")
main_plot(new_d_lexmv, "Lex MV Trigram")
pdf("~/Desktop/FG_project/plots/tri_baseline_dev_plots.pdf")
main_plot(new_d_lex, "Lex Trigram")
main_plot(new_d_phrasal, "Phrasal Trigram")
main_plot(new_d_lexcp, "Lex CP Trigram")
main_plot(new_d_lexmv, "Lex MV Trigram")
dev.off()
