theme = theme(plot.title = element_text(hjust = 0.5, size = 30)))
super_add_target <- filter(diff_mod_df, island_type == "Adjunct Island") %>%
ggplot(data=.,aes(x=condition, y = c(0,1.5))) +
geom_point(size = 2) +
geom_line(aes(group=island_type)) +
ylim(-2,4.5) +
ylab("island difference") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 24),
axis.text=element_text(size=20),
axis.title = element_text(size=22),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
) +
ggtitle("island effect")
# pdf("~/Desktop/FG_project/plots/superadd_diff_target.pdf")
# super_add_target
# dev.off()
### De Villiers results ###
d1 = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers/", model, "_mixed.0.devillier_stim_ld_wug.results.csv", sep = '')) %>% # for the noise analysis: d1 = read.csv(paste("~/Desktop/FG_project/data/", model, "_dev/", model, ".0.dev_ld.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(1:4) ~ "acceptable",
rowname %in% c(4:13) ~ "unacceptable"),
dependency_length = 'long',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d2 = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers/", model, "_mixed.0.devillier_stim_sd_wug.results.csv", sep = '')) %>% # for the noise analysis: d2 = read.csv(paste("~/Desktop/FG_project/data/", model, "_dev/", model, ".0.dev_sd.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(2:13) ~ "acceptable",
rowname %in% c(1) ~ "unacceptable"),
dependency_length = 'short',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
# want to add long distance preferences from the de Villiers paper
d3 = d1
d3$ld_preference = c(0.79, 0.48, 0.80, 0.25, 0.04, 0.03, 0.04, 0.09, 0.20, NA, NA, NA, NA)
p_orig_dev <- ggplot(data = d3[c(1:9),], mapping = aes(x = rowname, y = ld_preference, label = rowname)) +
geom_label() +
ggtitle('De Villiers Original Data')
# percentage difference
long <- d1$length_factorized
short <- d2$length_factorized
d1$long_pref = exp(long)/ (exp(long) + exp(short))
View(d1)
library(tidyverse)
library(forcats)
library(plotrix)
library(stringr)
library(ggpubr)
library(patchwork)
library(ggrepel)
# doing this a lot so will create a variable for folder the data is in
model = "FG"
# model = "noise_10_10"
# loading Liu et al. and Pearl and Sprouse data
setwd(paste("~/Desktop/FG_project/data/", model, "_pearl_liu", sep = ''))
temp = list.files(pattern="*.csv")
for (i in 1:length(temp)) assign(str_split_fixed(temp[i], "\\.0\\.", 2)[,2], read.csv(temp[i])) # lopping off the model run name
# liu et al stim data
bridge = liu_bridge.results.csv %>%
mutate(condition = 'bridge')
factive = liu_factive.results.csv %>%
mutate(condition = 'factive')
manner = liu_manner.results.csv %>%
mutate(condition = 'manner')
other = liu_other.results.csv %>%
mutate(condition = 'other')
d = rbind.data.frame(bridge, factive, manner, other)
d = d %>% mutate(Sentence = as.character(Sentence)) %>%
mutate(matrix_verb = word(Sentence, 2),
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
# # hacking d a bit so the complete noise condition (10) can produce a liu plot
# d$matrix_verb[1] = 'whine'
# d$matrix_verb[2] = 'say'
# loading verb-frame frequency data from liu et al
v_freq = read.csv("~/Desktop/FG_project/data/frequency_48verbs_unified_osf.csv")
insidescore_w_vfreq = d %>%
group_by(matrix_verb, condition) %>%
dplyr::summarise(InsideScore = mean(InsideScore),
LenFac = mean(length_factorized)) %>%
inner_join(v_freq)
### pearl & sprouse stim data
# matrix
matrix_non_is = pearl_stim_matrix.results.csv %>%
mutate(condition = 'main', island = "non-island structure")
matrix_is = pearl_stim_matrix.results.csv %>%
mutate(condition = 'main', island = "island structure")
# complex NP
np_emb_is = pearl_stim_np_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
np_emb_non_is = pearl_stim_np_emb_non_is.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
# subject
subject_emb_is = pearl_stim_subj_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
subject_emb_non_is = pearl_stim_subj_emb_nonis.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
# adjunct
adjunct_emb_is = pearl_stim_adjunct_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
adjunct_emb_non_is = pearl_stim_adjunct_emb_nonis.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
# whether
whether_emb_is = pearl_stim_whether_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
whether_emb_non_is = pearl_stim_whether_emb_nonis.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
d_np = rbind.data.frame(matrix_non_is, matrix_is, np_emb_non_is, np_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_subj = rbind.data.frame(matrix_non_is, matrix_is, subject_emb_non_is, subject_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_adjunct = rbind.data.frame(matrix_non_is, matrix_is, adjunct_emb_non_is, adjunct_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_whether = rbind.data.frame(matrix_non_is, matrix_is, whether_emb_non_is, whether_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
### liu plots ###
liu.plot <- ggplot(insidescore_w_vfreq, mapping = aes(x = log_fre, y = InsideScore)) +
stat_smooth(method = lm) +
geom_label(aes(label = matrix_verb)) + # , color = condition
xlab("Log-transformed frequency of verb frame") +
ylab("Log probability") +
labs(color = "Verb type")
liu.plot.lenfac <- ggplot(insidescore_w_vfreq, mapping = aes(x = log_fre, y = LenFac)) +
stat_smooth(method = lm) +
geom_label(aes(label = matrix_verb)) + # , color = condition
xlab("Log-transformed frequency of verb frame") +
ylab("Length Factorized Score") +
theme_classic() +
# labs(color = "Verb type") +
ggtitle("Liu et al. (2022) Stimuli") +
theme(plot.title = element_text(hjust = 0.5, size = 30),
axis.text=element_text(size=14),
axis.title = element_text(size=22))
liu_fit <- lm(LenFac ~ log_fre, data = insidescore_w_vfreq)
summary(liu_fit)
liu_cor = cor.test(insidescore_w_vfreq$LenFac, insidescore_w_vfreq$log_fre)
# # hacked plot for complete noise
# liu.plot.lenfac <- ggplot(insidescore_w_vfreq, mapping = aes(x = log_fre, y = LenFac)) +
#   stat_smooth(method = lm) +
#   xlab("Log-transformed frequency of verb frame") +
#   ylab("Length Factorized Score") +
#   theme_classic() +
#   # labs(color = "Verb type") +
#   ggtitle("Liu et al. (2022) Stimuli") +
#   theme(plot.title = element_text(hjust = 0.5, size = 30),
#         axis.text=element_text(size=14),
#         axis.title = element_text(size=22))
# ggsave('~/Desktop/FG_project/plots/liu_plot_FG.pdf',plot=liu.plot.lenfac,width = 16,height=9,units='cm')
### Pearl and Sprouse plots ###
toplot.df <- d_adjunct %>%
mutate(island_type = 'adjunct') %>%
rbind(d_np %>%
mutate(island_type = 'np')) %>%
rbind(d_subj %>%
mutate(island_type = 'subj')) %>%
rbind(d_whether %>%
mutate(island_type = 'whether')) %>%
mutate(condition = factor(condition,levels=c('main','embedded'))) %>%
mutate(island_type = as.character(island_type)) %>%
mutate(island_type = case_when(island_type == 'np' ~  'Complex NP Island',
island_type == 'subj' ~ 'Subject Island',
island_type == 'whether' ~ 'Whether Island',
island_type == 'adjunct' ~ 'Adjunct Island')) %>%
mutate(island_type = factor(island_type, levels=c('Complex NP Island','Subject Island','Whether Island','Adjunct Island')))
grid.plot <- toplot.df %>%
group_by(island_type,condition,island) %>%
dplyr::summarise(mean_InsideScore = mean(InsideScore),
stdErr = std.error(InsideScore)) %>%
ggplot(data=.,aes(x=condition,y=mean_InsideScore,color=island)) +
geom_point() +
geom_line(aes(group=island)) +
geom_errorbar(aes(x=condition, ymin = mean_InsideScore - stdErr, ymax = mean_InsideScore + stdErr), width=0.1) +
facet_wrap(~island_type,ncol=4) +
labs(y='Log Probability',x='Condition',color=element_blank()) +
theme(legend.position = 'bottom')
grid_len.plot <- toplot.df %>%
group_by(island_type,condition,island) %>%
dplyr::summarise(mean_length_factorized = mean(length_factorized), stdErr = std.error(length_factorized)) %>%
ggplot(data=.,aes(x=condition,y=mean_length_factorized,color=island)) +
geom_point() +
geom_line(aes(group=island)) +
geom_errorbar(aes(x=condition, ymin = mean_length_factorized - stdErr, ymax = mean_length_factorized + stdErr), width=0.1) +
facet_wrap(~island_type,ncol=4) +
labs(y='Log prob length factorized',x='Condition',color=element_blank()) +
theme(legend.position = 'bottom')
se_2mean <- function(vec) {
main = sqrt(vec[1]+vec[2])/4
return(main)
}
full_sprouse_diff <- data.frame(condition = c(rep("main", 8), rep("embedded", 8)),
island_type = rep(c("Complex NP Island", "Complex NP Island", "Subject Island", "Subject Island", "Whether Island", "Whether Island", "Adjunct Island", "Adjunct Island"), 2),
island = rep(c("non-island structure", "island structure"),8),
z_score = c(0.86, 0.75, 0.85, 0.75, 1.23, 0.71, 0.62, 0.11, 0.18, -0.73, 0.38, -0.97, 0.38, -0.73, 0.23, -0.97),
sd = c(0.76, 0.71, 0.77, 0.79, 0.74, 0.67, 0.80, 0.81, 0.82, 0.57, 0.83, 0.61, 0.72, 0.63, 0.79, 0.72)) %>%
mutate(condition = fct_relevel(condition, "main", "embedded"),
island_type = fct_relevel(island_type, "Complex NP Island", "Subject Island", "Whether Island", "Adjunct Island"),
var = sd^2)
se_2mean2 <- function(vec) {
main = sqrt(vec[1]+vec[2])/sqrt(173)
return(main)
}
diff_beh_df <- full_sprouse_diff %>%
group_by(condition, island_type) %>%
dplyr::summarise(diff = -diff(z_score), se = se_2mean2(var))
diff_mod_df <- toplot.df %>%
group_by(island_type,condition,island) %>%
dplyr::summarise(mean_length_factorized = -mean(length_factorized), var = var(length_factorized)) %>%
mutate_all(~replace(., is.na(.), 0)) %>%
group_by(condition, island_type) %>%
dplyr::summarise(diff = -diff(mean_length_factorized), se = se_2mean(var))
create_plot <- function(model_df, island_chars) {
LenFac_diff_mod.df <- filter(model_df, island_type == island_chars)
LenFac_diff_beh.df <- filter(diff_beh_df, island_type == island_chars) #diff_beh_df is the sprouse df
# scaleFactor <- max(LenFac_diff_mod.df$diff) / max(LenFac_diff_beh.df$diff)
scaleFactor <- 4.4
p <- ggplot(data=LenFac_diff_mod.df,aes(x=condition)) +
geom_point(aes(y=diff), col="#009E73", size = 2, show.legend = F) +
geom_point(data = LenFac_diff_beh.df, aes(y=diff * scaleFactor, color = '#CC79A7'), size = 2, show.legend = T) +
scale_y_continuous(name="model isl. diff", sec.axis=sec_axis(~./scaleFactor, name="behavior isl. diff"), limits = c(-1.5,14)) +
geom_line(aes(y = diff, group=island_type), color = "#009E73", linetype="dashed") +
geom_line(data = LenFac_diff_beh.df, aes(y=diff * scaleFactor, color = '#CC79A7', group=island_type)) +
geom_errorbar(aes(ymin = diff - se, ymax = diff + se), width=0.2, color = "#009E73") +
geom_errorbar(data = LenFac_diff_beh.df, aes(ymin = diff * scaleFactor - se, ymax = diff * scaleFactor + se), width=0.2, color = "#CC79A7") +
theme_bw() +
theme(legend.position = 'bottom',
plot.title = element_text(hjust = 0.5, size = 24),
axis.text=element_text(size=14),
axis.title = element_text(size=22),
axis.title.y.left=element_text(color="#009E73"),
axis.text.y.left=element_text(color="#009E73"),
axis.title.y.right=element_text(color="#CC79A7"),
axis.text.y.right=element_text(color="#CC79A7"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
) +
guides(color = "none")+
scale_color_manual(values = c('#CC79A7'), labels = c('')) +
# scale_color_manual(name='Regression Model',
#                    breaks=c('Linear', 'Quadratic', 'Cubic'),
#                    values=c('Cubic'='pink', 'Quadratic'='blue', 'Linear'='purple')) +
ggtitle(island_chars)
return(p)
}
diff_np_p = create_plot(diff_mod_df, "Complex NP Island")
diff_subj_p = create_plot(diff_mod_df, "Subject Island")
diff_adj_p = create_plot(diff_mod_df, "Adjunct Island")
diff_whether_p = create_plot(diff_mod_df, "Whether Island")
final_mod_beh_diff_plot <- (diff_np_p + diff_subj_p + diff_adj_p + diff_whether_p) +
plot_annotation(title = "Sprouse et al. Stim with Adult Data",
theme = theme(plot.title = element_text(hjust = 0.5, size = 30)))
mod_diff_plot <- function(model_df, island_chars) {
LenFac_diff_mod.df <- filter(model_df, island_type == island_chars)
p <- ggplot(data=LenFac_diff_mod.df,aes(x=condition, y = diff)) +
geom_point(aes(y=diff), size = 2, color = "#009E73") +
geom_line(aes(y = diff, group=island_type), color = "#009E73") +
geom_errorbar(aes(ymin = diff - se, ymax = diff + se), width=0.2, color = "#009E73") +
ylim(-1.5,14) +
ylab("isl. difference") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 24),
axis.text=element_text(size=14),
axis.title = element_text(size=22),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()
) +
ggtitle(island_chars)
return(p)
}
mod_diff_np_p = mod_diff_plot(diff_mod_df, "Complex NP Island")
mod_diff_subj_p = mod_diff_plot(diff_mod_df, "Subject Island")
mod_diff_adj_p = mod_diff_plot(diff_mod_df, "Adjunct Island")
mod_diff_whether_p = mod_diff_plot(diff_mod_df, "Whether Island")
mod_diff_p <- (mod_diff_np_p + mod_diff_subj_p + mod_diff_adj_p + mod_diff_whether_p) +
plot_annotation(title = "Sprouse et al. (2012) Stimuli",
theme = theme(plot.title = element_text(hjust = 0.5, size = 30)))
super_add_target <- filter(diff_mod_df, island_type == "Adjunct Island") %>%
ggplot(data=.,aes(x=condition, y = c(0,1.5))) +
geom_point(size = 2) +
geom_line(aes(group=island_type)) +
ylim(-2,4.5) +
ylab("island difference") +
theme_bw() +
theme(plot.title = element_text(hjust = 0.5, size = 24),
axis.text=element_text(size=20),
axis.title = element_text(size=22),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank()
) +
ggtitle("island effect")
# pdf("~/Desktop/FG_project/plots/superadd_diff_target.pdf")
# super_add_target
# dev.off()
### De Villiers results ###
d1 = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers/", model, "_mixed.0.devillier_stim_ld_wug.results.csv", sep = '')) %>% # for the noise analysis: d1 = read.csv(paste("~/Desktop/FG_project/data/", model, "_dev/", model, ".0.dev_ld.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(1:4) ~ "acceptable",
rowname %in% c(4:13) ~ "unacceptable"),
dependency_length = 'long',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d2 = read.csv(paste("~/Desktop/FG_project/data/", model, "_devilliers/", model, "_mixed.0.devillier_stim_sd_wug.results.csv", sep = '')) %>% # for the noise analysis: d2 = read.csv(paste("~/Desktop/FG_project/data/", model, "_dev/", model, ".0.dev_sd.results.csv", sep = '')) %>%
tibble::rownames_to_column(var = "rowname") %>%
mutate(condition = case_when(rowname %in% c(2:13) ~ "acceptable",
rowname %in% c(1) ~ "unacceptable"),
dependency_length = 'short',
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
# want to add long distance preferences from the de Villiers paper
d3 = d1
d3$ld_preference = c(0.79, 0.48, 0.80, 0.25, 0.04, 0.03, 0.04, 0.09, 0.20, NA, NA, NA, NA)
p_orig_dev <- ggplot(data = d3[c(1:9),], mapping = aes(x = rowname, y = ld_preference, label = rowname)) +
geom_label() +
ggtitle('De Villiers Original Data')
# percentage difference
long <- d1$length_factorized
short <- d2$length_factorized
d1$long_pref = exp(long)/ (exp(long) + exp(short))
plot.dev <- ggplot(data = d1, mapping = aes(x = as.numeric(rowname), y = long_pref, label = rowname)) +
geom_label() +
ylim(c(0,1)) +
ylab("Predicted Long-Distance Preference") +
xlab("de Villiers Item Number") +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
ggtitle('De Villiers Predicted Preferences')
combined_prefs <- tibble(pref = c(d1$long_pref[1:9], d3$ld_preference[1:9]),
type = c(rep("Model Prediction", 9), rep("Child Preference", 9)),
item = c(c(1:9),c(1:9)))
dev.scatter <- spread(combined_prefs, type, pref) %>%
ggplot(data = ., aes(x = `Child Preference`, y = `Model Prediction`)) + # , label = item
geom_point(size = 4) +
# geom_line() +
# geom_text_repel(size = 6) +
ylim(c(0,1)) +
xlim(c(0,1)) +
theme_classic() +
geom_hline(yintercept = 0.5, linetype="dashed") +
geom_vline(xintercept = 0.5, linetype="dashed") +
annotate('rect', xmin=0.5, xmax=1, ymin=0.5, ymax=1, alpha=.5, fill='gray') +
annotate('rect', xmin=0, xmax=0.5, ymin=0, ymax=0.5, alpha=.5, fill='gray') +
ggtitle("de Villiers et al. (2008) Stimuli") +
theme(plot.title = element_text(hjust = 0.5, size = 30),
axis.text=element_text(size=14),
axis.title = element_text(size=26))
dev.scatter
d1
View(d1)
library(tidyverse)
### De Villiers results ###
d_lex = read_csv("~/Desktop/FG_project/data/lex_trigram_model_dev_results.csv")
d_phrasal = read_csv("~/Desktop/FG_project/data/phrasal_trigram_model_dev_results.csv")
d_lexcp = read_csv("~/Desktop/FG_project/data/lexcp_trigram_model_dev_results.csv")
d_lexmv = read_csv("~/Desktop/FG_project/data/lexmv_trigram_model_dev_results.csv")
fix_d <- function(d) {
new_d = d %>%
mutate(length_factorized = log_prob / str_count(trigrams, "\\)"),
length = str_count(trigrams, "\\)"))
# help = length(trigrams)) # still not sure why this is only giving first element
return(new_d)
}
new_d_lex = fix_d(d_lex)
new_d_phrasal = fix_d(d_phrasal)
new_d_lexcp = fix_d(d_lexcp)
new_d_lexmv = fix_d(d_lexmv)
# library(plyr); library(dplyr)
# library(tidyverse)
# library(forcats)
# library(stringr)
# library(patchwork)
library(tidyverse)
library(forcats)
library(plotrix)
library(stringr)
library(ggpubr)
library(patchwork)
# creating a pdf to save plots
setwd("~/Desktop/FG_project/")
# pdf("./plots/tri_baseline_plots.pdf")
# # helper function from cookbook http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/#Helper%20functions
# summarySE <- function(data=NULL, measurevar, groupvars=NULL, na.rm=FALSE,
#                       conf.interval=.95, .drop=TRUE) {
#   library(plyr)
#
#   # New version of length which can handle NA's: if na.rm==T, don't count them
#   length2 <- function (x, na.rm=FALSE) {
#     if (na.rm) sum(!is.na(x))
#     else       length(x)
#   }
#
#   # This does the summary. For each group's data frame, return a vector with
#   # N, mean, and sd
#   datac <- ddply(data, groupvars, .drop=.drop,
#                  .fun = function(xx, col) {
#                    c(N    = length2(xx[[col]], na.rm=na.rm),
#                      mean = mean   (xx[[col]], na.rm=na.rm),
#                      sd   = sd     (xx[[col]], na.rm=na.rm)
#                    )
#                  },
#                  measurevar
#   )
#
#   # Rename the "mean" column
#   datac <- plyr::rename(datac, c('mean' = measurevar))
#
#   datac$se <- datac$sd / sqrt(datac$N)  # Calculate standard error of the mean
#
#   # Confidence interval multiplier for standard error
#   # Calculate t-statistic for confidence interval:
#   # e.g., if conf.interval is .95, use .975 (above/below), and use df=N-1
#   ciMult <- qt(conf.interval/2 + .5, datac$N-1)
#   datac$ci <- datac$se * ciMult
#
#   return(datac)
# }
#
# #### fully lex model plot
d_fully_lex_ps = read.csv("./data/lex_trigram_model_results.csv") %>%
mutate(length_factorized = log_prob / str_count(trigrams, "\\)"),
length = str_count(trigrams, "\\)"))
View(d_fully_lex_ps)
library(tidyverse)
library(forcats)
library(plotrix)
library(stringr)
library(ggpubr)
library(patchwork)
library(ggrepel)
# doing this a lot so will create a variable for folder the data is in
model = "FG"
# model = "noise_10_10"
# loading Liu et al. and Pearl and Sprouse data
setwd(paste("~/Desktop/FG_project/data/", model, "_pearl_liu", sep = ''))
temp = list.files(pattern="*.csv")
for (i in 1:length(temp)) assign(str_split_fixed(temp[i], "\\.0\\.", 2)[,2], read.csv(temp[i])) # lopping off the model run name
# liu et al stim data
bridge = liu_bridge.results.csv %>%
mutate(condition = 'bridge')
factive = liu_factive.results.csv %>%
mutate(condition = 'factive')
manner = liu_manner.results.csv %>%
mutate(condition = 'manner')
other = liu_other.results.csv %>%
mutate(condition = 'other')
d = rbind.data.frame(bridge, factive, manner, other)
d = d %>% mutate(Sentence = as.character(Sentence)) %>%
mutate(matrix_verb = word(Sentence, 2),
length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
# # hacking d a bit so the complete noise condition (10) can produce a liu plot
# d$matrix_verb[1] = 'whine'
# d$matrix_verb[2] = 'say'
# loading verb-frame frequency data from liu et al
v_freq = read.csv("~/Desktop/FG_project/data/frequency_48verbs_unified_osf.csv")
insidescore_w_vfreq = d %>%
group_by(matrix_verb, condition) %>%
dplyr::summarise(InsideScore = mean(InsideScore),
LenFac = mean(length_factorized)) %>%
inner_join(v_freq)
### pearl & sprouse stim data
# matrix
matrix_non_is = pearl_stim_matrix.results.csv %>%
mutate(condition = 'main', island = "non-island structure")
matrix_is = pearl_stim_matrix.results.csv %>%
mutate(condition = 'main', island = "island structure")
# complex NP
np_emb_is = pearl_stim_np_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
np_emb_non_is = pearl_stim_np_emb_non_is.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
# subject
subject_emb_is = pearl_stim_subj_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
subject_emb_non_is = pearl_stim_subj_emb_nonis.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
# adjunct
adjunct_emb_is = pearl_stim_adjunct_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
adjunct_emb_non_is = pearl_stim_adjunct_emb_nonis.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
# whether
whether_emb_is = pearl_stim_whether_emb_is.results.csv %>%
mutate(condition = 'embedded', island = "island structure")
whether_emb_non_is = pearl_stim_whether_emb_nonis.results.csv %>%
mutate(condition = 'embedded', island = "non-island structure")
d_np = rbind.data.frame(matrix_non_is, matrix_is, np_emb_non_is, np_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_subj = rbind.data.frame(matrix_non_is, matrix_is, subject_emb_non_is, subject_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_adjunct = rbind.data.frame(matrix_non_is, matrix_is, adjunct_emb_non_is, adjunct_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
d_whether = rbind.data.frame(matrix_non_is, matrix_is, whether_emb_non_is, whether_emb_is) %>%
mutate(length_factorized = MAPScore / (str_count(as.character(Sentence), ' ') + 1))
### liu plots ###
liu.plot <- ggplot(insidescore_w_vfreq, mapping = aes(x = log_fre, y = InsideScore)) +
stat_smooth(method = lm) +
geom_label(aes(label = matrix_verb)) + # , color = condition
xlab("Log-transformed frequency of verb frame") +
ylab("Log probability") +
labs(color = "Verb type")
liu.plot.lenfac <- ggplot(insidescore_w_vfreq, mapping = aes(x = log_fre, y = LenFac)) +
stat_smooth(method = lm) +
geom_label(aes(label = matrix_verb)) + # , color = condition
xlab("Log-transformed frequency of verb frame") +
ylab("Length Factorized Score") +
theme_classic() +
# labs(color = "Verb type") +
ggtitle("Liu et al. (2022) Stimuli") +
theme(plot.title = element_text(hjust = 0.5, size = 30),
axis.text=element_text(size=14),
axis.title = element_text(size=22))
liu_fit <- lm(LenFac ~ log_fre, data = insidescore_w_vfreq)
summary(liu_fit)
liu_cor = cor.test(insidescore_w_vfreq$LenFac, insidescore_w_vfreq$log_fre)
